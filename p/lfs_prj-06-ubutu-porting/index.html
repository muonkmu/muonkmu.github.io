<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='How to apply Ubuntu root file system on Zynq'>
<title>[LFS_prj] 06 Ubutu porting</title>

<link rel='canonical' href='https://muonkmu.github.io/p/lfs_prj-06-ubutu-porting/'>

<link rel="stylesheet" href="/scss/style.min.f3b6945bee58731371ef6d5a992e6775ef6e63b9642101b9f59903b1c9e16941.css"><meta property='og:title' content='[LFS_prj] 06 Ubutu porting'>
<meta property='og:description' content='How to apply Ubuntu root file system on Zynq'>
<meta property='og:url' content='https://muonkmu.github.io/p/lfs_prj-06-ubutu-porting/'>
<meta property='og:site_name' content='MW Devlog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='LFS' /><meta property='article:published_time' content='2023-03-18T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2023-03-18T00:00:00&#43;00:00'/>
<meta name="twitter:title" content="[LFS_prj] 06 Ubutu porting">
<meta name="twitter:description" content="How to apply Ubuntu root file system on Zynq">
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/minwook_large_hu93fbe6c7fccf94bb4165ea496a9d4637_41368_300x0_resize_q75_box.jpg" width="300"
                            height="246" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">MW Devlog</a></h1>
            <h2 class="site-description">Embedded Engineer (HW,SW,SYSTEM)</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/muonkmu'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://www.linkedin.com/in/minwook-kim-35a417154/'
                        target="_blank"
                        title="Linkedin"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-linkedin" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
 <path stroke="none" d="M0 0h24v24H0z" fill="none"/> <rect x="4" y="4" width="16" height="16" rx="2" /> <line x1="8" y1="11" x2="8" y2="16" /> <line x1="8" y1="8" x2="8" y2="8.01" /> <line x1="12" y1="16" x2="12" y2="11" />
 <path d="M16 16v-3a2 2 0 0 0 -4 0" />
</svg>
                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#techical-note">Techical note</a></li>
    <li><a href="#compiling-a-cross-toolchain">Compiling a Cross-Toolchain</a></li>
    <li><a href="#cross-compiling-temporary-tools">Cross Compiling Temporary Tools</a></li>
    <li><a href="#entering-chroot-and-building-additional-temporary-tools">Entering Chroot and Building Additional Temporary Tools</a>
      <ol>
        <li><a href="#entering-chroot-env-and-make-vfs">Entering Chroot env and make VFS</a></li>
        <li><a href="#building-additional-temporary-tools">Building Additional Temporary Tools</a></li>
      </ol>
    </li>
    <li><a href="#cleaning-and-backup">Cleaning and Backup</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/prj_lfs/" style="background-color: #A26465; color: #fff;">
                prj_LFS
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/lfs_prj-06-ubutu-porting/">[LFS_prj] 06 Ubutu porting</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            How to apply Ubuntu root file system on Zynq
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Mar 18, 2023</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    5 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    
        <section class="article-content">
    
    
    <p>LFS 시스템 빌드를 위한 cross tool chain의 설정과정을 다룬다.</p>
<h2 id="techical-note">Techical note</h2>
<p>LFS 시스템의 빌드 단계는 아래의 단계를 따른다</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Stage</th>
<th>Build</th>
<th>Host</th>
<th>Target</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>pc</td>
<td>pc</td>
<td>lfs</td>
<td>Build cross-compiler cc1 using cc-pc on pc.</td>
</tr>
<tr>
<td>2</td>
<td>pc</td>
<td>lfs</td>
<td>lfs</td>
<td>Build compiler cc-lfs using cc1 on pc.</td>
</tr>
<tr>
<td>3</td>
<td>lfs</td>
<td>lfs</td>
<td>lfs</td>
<td>Rebuild and test cc-lfs using cc-lfs on lfs</td>
</tr>
</tbody>
</table></div>
<p>여기서 1단계와 2단계가 cross compiler를 구축하는 단계이고 3단계는 chroot와 cross compiler를 이용한 LFS 시스템을 만드는 단계이다.
cross compiler를 만드는 단계가 2단계로 구분되어 있는 이유는 하기와 같이 설명하고 있다.</p>
<ul>
<li>C언어는 단순컴파일러가 아니라 표준 라이브러리(glib)도 정의하는데 이는 cc1으로 컴파일되어야 함</li>
<li>그런데 컴파일러는 내부 라이브러리 libgcc를 이용해 컴파일하는데 이는 glib에 연결되어 있어야함</li>
<li>이 상호 의존 문제를 해결하기 위해 먼저 cc1 및 libgcc(스레드,예외처리 일부 기능이 부족한)를 만들고 이를 이용해 glib을 만듬(glib은 성능저하 없음)</li>
<li>그 다음 2단계에서 cc1을 이용해 cc-lfs를 만드며 이때 libgcc 및 llibstdc++도 다시 만듬</li>
</ul>
<p>그리고 3단계(chroot) 환경에서 기존에 만든 패키지가 있음에도 다시 모든 패키지를 빌드하는데 이는 LSF를 안정적으로 만들어 준다.(2단계에서 만든 패키지들이 몇가지 디펜던시가 부족하므로)</p>
<p>(이해하기 좀 빡세다&hellip;해보면 이해간다는데 해봐도 머리속이 클리어하지 않다.)</p>
<h2 id="compiling-a-cross-toolchain">Compiling a Cross-Toolchain</h2>
<p>위의 1단계, cc1을 빌드하고 glib을 만든다. 그리고 cc-lfs도 만들 수 있도록 libstdc++도 추출함</p>
<ol>
<li>
<p>Binutils-2.40 - Pass 1</p>
<ul>
<li>linker, an assembler, and other tools for handling object files</li>
<li>&ndash;prefix=$LFS/tools, &ndash;with-sysroot=$LFS 옵션으로 볼 때 host환경에서 쓴다는 것을 알 수 있다.</li>
</ul>
</li>
<li>
<p>GCC-12.2.0 - Pass 1</p>
<ul>
<li>-prefix=$LFS/tools, &ndash;with-sysroot=$LFS 옵션으로 볼 때 host환경에서 사용</li>
<li>&ndash;disable-shared에서 내부 라이브러리를 정적으로 쓰도록 함, 호스트의 동적 라이브러리로 인한 문제 차단</li>
<li>&ndash;disable-libstdcxx 등 : 위에서 설명한 일부기능이 부족한 cc1이 됨</li>
</ul>
</li>
<li>
<p>Linux-6.1.11 API Headers</p>
<ul>
<li>리눅스 커널에서 Glibc에 쓰이는 커널 API인 리눅스 API 헤더를 추출</li>
</ul>
</li>
<li>
<p>Glibc-2.37</p>
<ul>
<li>Glibc 패키지는 메인 C 라이브러리를 포함하고 있다. 이 라이브러리는 메모리 할당, 디렉토리 검색, 파일 열기 및 닫기, 파일 읽기 및 쓰기, 문자열 처리, 패턴 대조, 산술 등의 기본 루틴을 제공한다</li>
<li>&ndash;prefix=/usr 로 볼때 빌드된 것이 LFS 시스템 상에서 사용됨을 알 수 있다.</li>
<li>&ndash;host=$LFS_TGT, &ndash;build=$(../scripts/config.guess) 는 이전의 gcc와 binutil등을 이용해서 크로스 컴파일함</li>
</ul>
</li>
<li>
<p>Libstdc++ from GCC-12.2.0</p>
<ul>
<li>c++을 설치하기 위해서 Libstdc++가 필요한데 Glibc에 디펜던시를 가지므로 gcc 설치 시 설치하지 않았다.</li>
<li>Glibc와 같이 &ndash;prefix=/usr, &ndash;host=$LFS_TGT, &ndash;build=$(../scripts/config.guess) 구성을 사용</li>
</ul>
</li>
</ol>
<h2 id="cross-compiling-temporary-tools">Cross Compiling Temporary Tools</h2>
<p>위 기술노트의 2단계, cc-lfs를 구축한다.</p>
<ol>
<li>M4-1.4.19
<ul>
<li>매크로 처리기</li>
</ul>
</li>
<li>Ncurses-6.4
<ul>
<li>문자 화면의 터미널 독립적 처리를 위한 라이브러리를 포함(clear, tab 같은)</li>
</ul>
</li>
<li>Bash-5.2.15
<ul>
<li>배쉬 쉘</li>
</ul>
</li>
<li>Coreutils-9.1
<ul>
<li>기본적인 시스템 특성을 보여주고 설정하기 위한 유틸리티(cat, chmod, cp, dd 등등)</li>
</ul>
</li>
<li>Diffutils-3.9
<ul>
<li>diff 유틸</li>
</ul>
</li>
<li>File-5.44
<ul>
<li>file 명령어 util</li>
</ul>
</li>
<li>Findutils-4.9.0
<ul>
<li>Findutils 패키지는 파일을 찾는 프로그램을 포함(find 등)</li>
</ul>
</li>
<li>Gawk-5.2.1
<ul>
<li>텍스트 편집에 최적화된 스크립트 언어</li>
</ul>
</li>
<li>Grep-3.8</li>
<li>Gzip-1.12</li>
<li>Make-4.4</li>
<li>Patch-2.7.6</li>
<li>Sed-4.9</li>
<li>Tar-1.34</li>
<li>Xz-5.4.1</li>
<li>Binutils-2.40 - Pass 2</li>
<li>GCC-12.2.0 - Pass 2</li>
</ol>
<h2 id="entering-chroot-and-building-additional-temporary-tools">Entering Chroot and Building Additional Temporary Tools</h2>
<p>위의 빌드를 위한 임시 시스템에서 필요한 몇가지 패키지를 chroot의 분리된 환경에서 설치한다.</p>
<ul>
<li>상기 패키지를 host환경이 아닌 LFS 환경에서 설치하는 이유는 나와있지 않다.</li>
<li>LFS ver9에서는 chroot로 LFS 환경으로 들어가기 이전에 모든 빌드 시스템 구축을 끝낸다.(이게 더 이해가 쉬운듯)</li>
</ul>
<h3 id="entering-chroot-env-and-make-vfs">Entering Chroot env and make VFS</h3>
<p>현재까지 만들어진 파일 시스템은 lfs 소유인데 이는 다른 유저가 파일을 조작할 권리를 얻을 수 있으므로 소유자를 root로 변환</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">chown -R root:root <span class="nv">$LFS</span>/<span class="o">{</span>usr,lib,var,etc,bin,sbin,tools<span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="k">case</span> <span class="k">$(</span>uname -m<span class="k">)</span> in
</span></span><span class="line"><span class="cl">  x86_64<span class="o">)</span> chown -R root:root <span class="nv">$LFS</span>/lib64 <span class="p">;;</span>
</span></span><span class="line"><span class="cl"><span class="k">esac</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>/dev</code> 등 필요한 가상 커널 파일 시스템을 생성한다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir -pv <span class="nv">$LFS</span>/<span class="o">{</span>dev,proc,sys,run<span class="o">}</span>
</span></span><span class="line"><span class="cl">mount -v --bind /dev <span class="nv">$LFS</span>/dev
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mount -v --bind /dev/pts <span class="nv">$LFS</span>/dev/pts
</span></span><span class="line"><span class="cl">mount -vt proc proc <span class="nv">$LFS</span>/proc
</span></span><span class="line"><span class="cl">mount -vt sysfs sysfs <span class="nv">$LFS</span>/sys
</span></span><span class="line"><span class="cl">mount -vt tmpfs tmpfs <span class="nv">$LFS</span>/run
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> -h <span class="nv">$LFS</span>/dev/shm <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">  mkdir -pv <span class="nv">$LFS</span>/<span class="k">$(</span>readlink <span class="nv">$LFS</span>/dev/shm<span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span>
</span></span><span class="line"><span class="cl">  mount -t tmpfs -o nosuid,nodev tmpfs <span class="nv">$LFS</span>/dev/shm
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>chroot를 이용하여 LFS환경으로 진입한다</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">chroot <span class="s2">&#34;</span><span class="nv">$LFS</span><span class="s2">&#34;</span> /usr/bin/env -i   <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="nv">HOME</span><span class="o">=</span>/root                  <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="nv">TERM</span><span class="o">=</span><span class="s2">&#34;</span><span class="nv">$TERM</span><span class="s2">&#34;</span>                <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="nv">PS1</span><span class="o">=</span><span class="s1">&#39;(lfs chroot) \u:\w\$ &#39;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="nv">PATH</span><span class="o">=</span>/usr/bin:/usr/sbin     <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    /bin/bash --login
</span></span></code></pre></td></tr></table>
</div>
</div><p>리눅스 표준 디렉토리 트리를 생성한다(리눅스 파일 시스템 계층 표준 기반)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">mkdir -pv /<span class="o">{</span>boot,home,mnt,opt,srv<span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mkdir -pv /etc/<span class="o">{</span>opt,sysconfig<span class="o">}</span>
</span></span><span class="line"><span class="cl">mkdir -pv /lib/firmware
</span></span><span class="line"><span class="cl">mkdir -pv /media/<span class="o">{</span>floppy,cdrom<span class="o">}</span>
</span></span><span class="line"><span class="cl">mkdir -pv /usr/<span class="o">{</span>,local/<span class="o">}{</span>include,src<span class="o">}</span>
</span></span><span class="line"><span class="cl">mkdir -pv /usr/local/<span class="o">{</span>bin,lib,sbin<span class="o">}</span>
</span></span><span class="line"><span class="cl">mkdir -pv /usr/<span class="o">{</span>,local/<span class="o">}</span>share/<span class="o">{</span>color,dict,doc,info,locale,man<span class="o">}</span>
</span></span><span class="line"><span class="cl">mkdir -pv /usr/<span class="o">{</span>,local/<span class="o">}</span>share/<span class="o">{</span>misc,terminfo,zoneinfo<span class="o">}</span>
</span></span><span class="line"><span class="cl">mkdir -pv /usr/<span class="o">{</span>,local/<span class="o">}</span>share/man/man<span class="o">{</span>1..8<span class="o">}</span>
</span></span><span class="line"><span class="cl">mkdir -pv /var/<span class="o">{</span>cache,local,log,mail,opt,spool<span class="o">}</span>
</span></span><span class="line"><span class="cl">mkdir -pv /var/lib/<span class="o">{</span>color,misc,locate<span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ln -sfv /run /var/run
</span></span><span class="line"><span class="cl">ln -sfv /run/lock /var/lock
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">install -dv -m <span class="m">0750</span> /root
</span></span><span class="line"><span class="cl">install -dv -m <span class="m">1777</span> /tmp /var/tmp
</span></span></code></pre></td></tr></table>
</div>
</div><p>리눅스는 마운트된 파일시스템의 리스트를 <code>/etc/mtab</code>에 관리하고 이를 <code>/proc</code>에 노출시키므로 이를 위한 심볼릭 링크를 생성</p>
<ul>
<li>mtab은 mount command에 의해 자동갱신됨, fstab은 부팅 시 마운트할 목록</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ln -sv /proc/self/mounts /etc/mtab
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>host</code> 파일과 <code>/etc/passwd</code>. <code>/etc/group</code>을 생성한다. 필요 시 테스트를 위한 테스트 그룹도 생성하고 재로그인 한다.
생성된 그룹은 어떤 표준에도 속하지 않는  Udev 구성의 요구사항에 의해 만들어진 그룹이다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cat &gt; /etc/hosts <span class="s">&lt;&lt; EOF
</span></span></span><span class="line"><span class="cl"><span class="s">127.0.0.1  localhost $(hostname)
</span></span></span><span class="line"><span class="cl"><span class="s">::1        localhost
</span></span></span><span class="line"><span class="cl"><span class="s">EOF</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cat &gt; /etc/passwd &lt;&lt; <span class="s2">&#34;EOF&#34;</span>
</span></span><span class="line"><span class="cl">root:x:0:0:root:/root:/bin/bash
</span></span><span class="line"><span class="cl">bin:x:1:1:bin:/dev/null:/usr/bin/false
</span></span><span class="line"><span class="cl">daemon:x:6:6:Daemon User:/dev/null:/usr/bin/false
</span></span><span class="line"><span class="cl">messagebus:x:18:18:D-Bus Message Daemon User:/run/dbus:/usr/bin/false
</span></span><span class="line"><span class="cl">systemd-journal-gateway:x:73:73:systemd Journal Gateway:/:/usr/bin/false
</span></span><span class="line"><span class="cl">systemd-journal-remote:x:74:74:systemd Journal Remote:/:/usr/bin/false
</span></span><span class="line"><span class="cl">systemd-journal-upload:x:75:75:systemd Journal Upload:/:/usr/bin/false
</span></span><span class="line"><span class="cl">systemd-network:x:76:76:systemd Network Management:/:/usr/bin/false
</span></span><span class="line"><span class="cl">systemd-resolve:x:77:77:systemd Resolver:/:/usr/bin/false
</span></span><span class="line"><span class="cl">systemd-timesync:x:78:78:systemd Time Synchronization:/:/usr/bin/false
</span></span><span class="line"><span class="cl">systemd-coredump:x:79:79:systemd Core Dumper:/:/usr/bin/false
</span></span><span class="line"><span class="cl">uuidd:x:80:80:UUID Generation Daemon User:/dev/null:/usr/bin/false
</span></span><span class="line"><span class="cl">systemd-oom:x:81:81:systemd Out Of Memory Daemon:/:/usr/bin/false
</span></span><span class="line"><span class="cl">nobody:x:65534:65534:Unprivileged User:/dev/null:/usr/bin/false
</span></span><span class="line"><span class="cl">EOF
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cat &gt; /etc/group &lt;&lt; <span class="s2">&#34;EOF&#34;</span>
</span></span><span class="line"><span class="cl">root:x:0:
</span></span><span class="line"><span class="cl">bin:x:1:daemon
</span></span><span class="line"><span class="cl">sys:x:2:
</span></span><span class="line"><span class="cl">kmem:x:3:
</span></span><span class="line"><span class="cl">tape:x:4:
</span></span><span class="line"><span class="cl">tty:x:5:
</span></span><span class="line"><span class="cl">daemon:x:6:
</span></span><span class="line"><span class="cl">floppy:x:7:
</span></span><span class="line"><span class="cl">disk:x:8:
</span></span><span class="line"><span class="cl">lp:x:9:
</span></span><span class="line"><span class="cl">dialout:x:10:
</span></span><span class="line"><span class="cl">audio:x:11:
</span></span><span class="line"><span class="cl">video:x:12:
</span></span><span class="line"><span class="cl">utmp:x:13:
</span></span><span class="line"><span class="cl">usb:x:14:
</span></span><span class="line"><span class="cl">cdrom:x:15:
</span></span><span class="line"><span class="cl">adm:x:16:
</span></span><span class="line"><span class="cl">messagebus:x:18:
</span></span><span class="line"><span class="cl">systemd-journal:x:23:
</span></span><span class="line"><span class="cl">input:x:24:
</span></span><span class="line"><span class="cl">mail:x:34:
</span></span><span class="line"><span class="cl">kvm:x:61:
</span></span><span class="line"><span class="cl">systemd-journal-gateway:x:73:
</span></span><span class="line"><span class="cl">systemd-journal-remote:x:74:
</span></span><span class="line"><span class="cl">systemd-journal-upload:x:75:
</span></span><span class="line"><span class="cl">systemd-network:x:76:
</span></span><span class="line"><span class="cl">systemd-resolve:x:77:
</span></span><span class="line"><span class="cl">systemd-timesync:x:78:
</span></span><span class="line"><span class="cl">systemd-coredump:x:79:
</span></span><span class="line"><span class="cl">uuidd:x:80:
</span></span><span class="line"><span class="cl">systemd-oom:x:81:
</span></span><span class="line"><span class="cl">wheel:x:97:
</span></span><span class="line"><span class="cl">users:x:999:
</span></span><span class="line"><span class="cl">nogroup:x:65534:
</span></span><span class="line"><span class="cl">EOF
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">exec</span> /usr/bin/bash --login
</span></span></code></pre></td></tr></table>
</div>
</div><p>마지막으로 login, agetty 및 init 들은 로그파일이 존재하지 않으면 로그를 남기지 않으므로 파일을 미리 생성해준다.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">touch /var/log/<span class="o">{</span>btmp,lastlog,faillog,wtmp<span class="o">}</span>
</span></span><span class="line"><span class="cl">chgrp -v utmp /var/log/lastlog
</span></span><span class="line"><span class="cl">chmod -v <span class="m">664</span>  /var/log/lastlog
</span></span><span class="line"><span class="cl">chmod -v <span class="m">600</span>  /var/log/btmp
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="building-additional-temporary-tools">Building Additional Temporary Tools</h3>
<p>하기 패키지를 설치한다.</p>
<ol>
<li>Gettext-0.21.1
<ul>
<li>다국어화와 현지화를 위한 유틸리티가 포함, 프로그램을 현지 언어를 지원하도록 컴파일 할 수 있음</li>
</ul>
</li>
<li>Bison-3.8.2
<ul>
<li>파서 생성기가 포함(?)</li>
</ul>
</li>
<li>Perl-5.36.0</li>
<li>Python-3.11.2</li>
<li>Texinfo-7.0.2
<ul>
<li>info 페이지를 읽고, 쓰고, 변환하는 프로그램(man보다 자세하다고 함)</li>
</ul>
</li>
<li>Util-linux-2.38.1
<ul>
<li>파일 시스템, 콘솔, 파티션 및 메시지를 처리하는 유틸리티가 포함된 패키지</li>
</ul>
</li>
</ol>
<h2 id="cleaning-and-backup">Cleaning and Backup</h2>
<p>툴체인 셋업이 완료되었으므로 필요하다면 현재구성을 백업하도록 하자.
상세 내용은 메뉴얼 참조</p>

</section>

    

    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/lfs/">LFS</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/p/lfs_prj-05-final-debugging/">
        
        

        <div class="article-details">
            <h2 class="article-title">[LFS_prj] 05 Final debugging</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/lfs_prj-04-building-the-lfs-system/">
        
        

        <div class="article-details">
            <h2 class="article-title">[LFS_prj] 04 Building the LFS system</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/lfs_prj-02-host-setting/">
        
        

        <div class="article-details">
            <h2 class="article-title">[LFS_prj] 02 Host setting</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/lfs_prj-01-lfs-project-propsal/">
        
        

        <div class="article-details">
            <h2 class="article-title">[LFS_prj] 01 LFS project propsal</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hugo-theme-stack" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (typeof DISQUS == 'object') {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2022 - 
        
        2024 MW Devlog
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.16.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

                
            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
